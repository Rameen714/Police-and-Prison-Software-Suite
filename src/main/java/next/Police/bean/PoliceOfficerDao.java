package next.Police.bean;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class PoliceOfficerDao {

	public boolean Search(String ID)  throws Exception
	{
		String dbUrl = "jdbc:sqlserver://VALEENAAFZAL;database=PoliceSystem;integratedSecurity = true; encrypt=true;trustServerCertificate=true";

		boolean status = false;
		String Officer ="Junior";
		try(Connection con = DriverManager.getConnection(dbUrl); Statement stmt = con.createStatement();)
		{
			System.out.println("In PO_DAO_TRy");
			String sql = "SELECT * FROM PoliceOfficer where ID = ? and Rank = ?";
			PreparedStatement ps;
			ps = con.prepareStatement(sql);
			ps.setString(1, ID);
			ps.setString(2, Officer);
			ResultSet rs = ps.executeQuery();
			while(rs.next() == true)
			{
				System.out.println(rs.getString("Rank"));
				status = true;
			}
			con.close();
			return status;

		}
        catch (SQLException e) 
        {
			e.printStackTrace();
		} 

		return false;
	}
	
	public Boolean checkOfficer(String OfficerID )
	{
		String dbUrl = "jdbc:sqlserver://VALEENAAFZAL;database=PoliceSystem;integratedSecurity = true; encrypt=true;trustServerCertificate=true";
		
		
        try (Connection con = DriverManager.getConnection(dbUrl); Statement stmt = con.createStatement();) 
        {
        	// first retrieve to see if there is any appointment at that time if not insert
        	String sql = "SELECT * FROM PoliceOfficer WHERE ID = ?";
			PreparedStatement ps1;
			ps1 = con.prepareStatement(sql);
			ps1.setString(1, OfficerID );
			
			ResultSet rs = ps1.executeQuery();
			
//			if(rs.next() == true)
//				return false;
			if(rs.next() == true) {
				 
//                myID = rs.getString("ID");
//                myName = rs.getString("name");
//                String _Status = rs.getString("status");
//                if(_Status == "Inuse")
//                {
//                	myStatus = true;
//                	
//                }
//                else
//                {
//                	myStatus = false;
//                }
                return true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            }
        } 
        catch (SQLException e) 
        {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}   
		return false;	
	}
	
}
